(function(e){function c(a,b){this._=a;this.wid=null;this.debug=!1;this.itemNum=this.dots=this.stage=this.outer=this.items=this.oItemNum=null;this.resetAB=this.epsilon=this.totalDots=this.xEnd=this.xStart=this.x=0;this.prevColNum=-1;"object"!=typeof b&&(b={});this.rtl="rtl"==this._.css("direction");this.opt=e.extend({},c.Defaults,b);this.colNum=this.opt.columnNumber;this.margin=this.opt.margin;this.wrapperClass="."+this.opt.wrapperClass;this.outerClass="."+this.opt.outerClass;this.stageClass="."+this.opt.stageClass;
this.itemClass="."+this.opt.itemClass;this.dotsClass="."+this.opt.dotsClass;this.dotClass="."+this.opt.dotClass;this.navClass="."+this.opt.navClass;this.nextClass="."+this.opt.nextClass;this.prevClass="."+this.opt.prevClass;this.activeClass="."+this.opt.activeClass;isNaN(this.opt.displayDuration)?this.opt.displayDuration=c.Defaults.displayDuration:this.opt.displayDuration=Number(this.opt.displayDuration);isNaN(this.opt.animateDuration)?this.opt.animateDuration=c.Defaults.animateDuration:this.opt.animateDuration=
Number(this.opt.animateDuration);this.xCSS=this.left=this.rtl?"right":"left";this.displaying=null;this.dragging=this.drag=this.hover=this.animating=!1;this.init(!1)}c.Defaults={columnNumber:1,minColumnWidth:150,margin:20,maxMargin:6.25,displayDuration:3E3,animateDuration:500,dotsClass:"sneeit-carousel-dots",dotClass:"sneeit-carousel-dot",dotText:function(a){return"&bull;"},navClass:"sneeit-carousel-nav",prevClass:"sneeit-carousel-prev",nextClass:"sneeit-carousel-next",prevText:function(a){return"&lang;"},
nextText:function(a){return"&rang;"},wrapperClass:"sneeit-carousel",outerClass:"sneeit-carousel-outer",stageClass:"sneeit-carousel-stage",itemClass:"sneeit-carousel-item",activeClass:"active"};c.prototype.animate=function(a,b){if(!(this.colNum>=this.oItemNum)){this.animating=a;"undefined"==typeof a&&(a=this.x-this.iWid);this.activeDot(a);this.activeNav(a);var d={};d[this.xCSS]=a+"%";"undefined"==typeof b&&(b=this.opt.animateDuration);var c=this;"function"==typeof this.opt.animate&&this.opt.animate({this:c,
x:a});this.debug&&console.log("animate",a,b,d,this);this.stage.stop().animate(d,b,function(){c.x=a;c.animating=!1;"function"==typeof c.opt.animated&&c.opt.animated({this:c});c.display()})}};c.prototype.getX=function(){this.debug&&console.log("getX");var a=this.stage.css(this.xCSS);a=Number(a.replace("px",""));return 100*a/this.wid};c.prototype.resetX=function(){var a=!1;this.x<=this.xEnd?(this.x+=this.resetAB,a=!0):this.x>=this.xStart&&(this.x-=this.resetAB,a=!0);a&&this.stage.css(this.xCSS,this.x+
"%");this.debug&&console.log("resetX",a,this)};c.prototype.activeItem=function(){for(var a=0,b=this.x,d=this.x-this.colNum*this.iWid,c=0;c<this.itemNum;c++)a=-(c*this.iWid+this.iWid/2),a<b&&a>d?e(this.items[c]).addClass(this.opt.activeClass):e(this.items[c]).removeClass(this.opt.activeClass);this.debug&&console.log("activeItem",a,b,d,this)};c.prototype.display=function(){this.resetX();var a=this;this.activeDot(this.x);this.activeNav(this.x);this.activeItem();this.debug?console.log("display",this):
this.displaying=setTimeout(function(){clearTimeout(a.displaying);a.displaying=null;a.hover||a.animate()},this.opt.displayDuration)};c.prototype.stop=function(){this.debug&&console.log("stop");this.stage.stop();null!=this.displaying&&(clearTimeout(this.displaying),this.displaying=null);this.x=this.getX()};c.prototype.init=function(a){a&&(this.stop(),this.colNum=this.opt.columnNumber,this.margin=this.opt.margin,this.stage.css(this.xCSS,0),this.x=0);var b=null;if(!a){b=this._.find(">*");this.oItemNum=
b.length;if(!this.oItemNum)return;this.colNum||(this.colNum=1);this.colNum>this.oItemNum&&(this.colNum=this.oItemNum)}this.wid=this._.width();this._.css("width",this.wid+"px");if(this.wid){100*this.margin/this.wid>this.opt.maxMargin&&(this.margin=this.opt.maxMargin*this.wid/100);var d=(this.colNum-1)*this.margin;1>=this.colNum&&(d=0);for(d=(this.wid-d)/this.colNum;1<this.colNum&&d<this.opt.minColumnWidth&&!(d=this.wid/this.colNum,1>=this.colNum||d>=this.opt.minColumnWidth);this.colNum--);0==this.colNum&&
(this.colNum=1);d=(this.colNum-1)*this.margin;d=(this.wid-d)/this.colNum;if(!a||this.colNum!=this.prevColNum){this.prevColNum=this.colNum;a||(b.wrap('<div class="'+this.opt.itemClass+'"></div>'),this._.wrapInner('<div class="'+this.opt.stageClass+'"></div>'),this._.wrapInner('<div class="'+this.opt.outerClass+'"></div>'),b=this._.find(this.itemClass),this.stage=this._.find(this.stageClass),this.outer=this._.find(this.outerClass),b.clone().prependTo(this.stage),b.clone().appendTo(this.stage),this.items=
this._.find(this.itemClass),this.itemNum=this.items.length);b=this.itemNum*d+(this.itemNum-1)*this.margin;var c=100*this.margin/b;this.iWid=100*d/this.wid+100*this.margin/this.wid;this.epsilon=100/this.wid/10;this.resetAB=this.oItemNum*this.iWid;this.xStart=-(this.oItemNum-this.colNum-1)*this.iWid;this.xEnd=-(2*this.oItemNum+this.colNum-2)*this.iWid;this.totalDots=Math.ceil(this.oItemNum/this.colNum);this.outer.css({overflow:"hidden",position:"relative"});this.stage.css({position:"relative",width:100*
b/this.wid+"%","max-width":"none"});this.items.css({width:100*d/b+"%","float":this.left});c&&this.items.css("margin-"+this.left,c+"%");e(this.items[0]).css("margin-"+this.left,0);this.debug&&console.log("init",this);this.display();this.enableDots();a||(this.enableDrag(),this.enableKeyboard(),this.enableResponsive(),this.enableNav(),this.enableHover(),this._.addClass(this.opt.wrapperClass))}}};c.prototype.getPageX=function(a){this.debug&&console.log("getPageX");return"undefined"==typeof a.pageX&&"undefined"!=
typeof a.originalEvent.touches[0].clientX?a.originalEvent.touches[0].clientX:a.pageX};c.prototype.dragStart=function(){};c.prototype.dragMove=function(){};c.prototype.dragMove=function(){};c.prototype.enableDrag=function(){this.debug&&console.log("enableDrag");var a=this;this.stage.on("mousedown",function(b){b.preventDefault();if(!1!==a.drag)return!1;b.pageX=a.getPageX(b);a.drag=b.pageX;a.stop();return!1});e(document).on("mousemove",function(b){if(!1!==a.drag)return b.preventDefault(),b.pageX=a.getPageX(b),
a.x=a.rtl?a.x-100*(b.pageX-a.drag)/a.wid:a.x+100*(b.pageX-a.drag)/a.wid,b.pageX<a.drag?a.dragging="left":b.pageX>a.drag&&(a.dragging="right"),a.drag=b.pageX,a.stage.css(a.xCSS,a.x+"%"),a.resetX(),!1});this.stage.find("a[href]").on("click",function(b){if(a.dragging)return b.preventDefault(),!1});e(document).on("mouseup",function(){if(!1!==a.drag){for(var b=0,d=0;d<a.itemNum-1&&!(b=-(d*a.iWid),a.x<b-a.epsilon&&a.x>b-a.iWid+a.epsilon);d++);d>=a.itemNum-1?(a.drag=!1,a.dragging=!1,a.display()):(b=-(d*
a.iWid),a.dragging==a.left&&(b-=a.iWid),a.animate(b),setTimeout(function(){a.drag=!1;a.dragging=!1},5))}});e.support.touch="ontouchend"in document;e.support.touch&&(this.stage.on("touchmove",function(b){if(!(1<b.originalEvent.touches.length)){var d=b.originalEvent.changedTouches[0];if(null!=a.touch){var c=d.pageX-a.touch.pageX;Math.abs(c)<Math.abs(d.pageY-a.touch.pageY)||(a.stop(),b.pageX=d.pageX,a.x=a.rtl?a.x-100*c/a.wid:a.x+100*c/a.wid,0>c?a.dragging="left":0<c&&(a.dragging="right"),a.stage.css(a.xCSS,
a.x+"%"),a.resetX())}a.touch=d}}),this.stage.on("touchend",function(b){if(null!==a.touch){a.touch=null;for(var c=b=0;c<a.itemNum-1&&!(b=-(c*a.iWid),a.x<b-a.epsilon&&a.x>b-a.iWid+a.epsilon);c++);c>=a.itemNum-1?(a.dragging=!1,a.display()):(b=-(c*a.iWid),a.dragging==a.left&&(b-=a.iWid),a.animate(b),setTimeout(function(){a.dragging=!1},5))}}))};c.prototype.activeDot=function(a){!this.debug&&this.dots&&(a=Math.round(Math.abs(a/this.iWid))%this.oItemNum,a=Math.floor(a/this.colNum),this.dots.removeClass(this.opt.activeClass),
e(this.dots[a]).addClass(this.opt.activeClass))};c.prototype.enableDots=function(){this.debug&&console.log("enableDots");if(this.totalDots&&this.opt.dotsClass&&this.opt.dotClass){for(var a="",b=this,c=0;c<this.totalDots;c++){var f="";f="function"==typeof this.opt.dotText?this.opt.dotText({this:b,dotIndex:c}):this.opt.dotText;if(!1===f)return;a+='<div class="'+this.opt.dotClass+'" data-index="'+c+'">'+f+"</div>"}null!=this.dots?this._.find(this.dotsClass).html(a):(a='<div class="'+this.opt.dotsClass+
'">'+a+"</div>",this._.append(a));this.dots=this._.find(this.dotClass);e(this.dots[0]).addClass(this.opt.activeClass);this.dots.click(function(){var a=e(this).attr("data-index");if("undefined"!=typeof a&&!isNaN(a)){b.stop();a=Number(a);a=-a*b.colNum*b.iWid;for(var c=a-b.x,d=b.itemNum/b.oItemNum,f=b.resetAB,g=1;g<d;g++){var h=a-g*f-b.x;Math.abs(h)<Math.abs(c)&&(c=h)}a=c+b.x;Math.abs(c)<b.epsilon?b.display():b.animate(a)}})}};c.prototype.activeNav=function(a){this.debug?console.log("activeNav",a,this):
(a="function"==typeof this.opt.prevText?this.opt.prevText({this:this}):this.opt.prevText,!1!==a&&this.opt.prevClass&&this._.find(this.prevClass).html(a),a="function"==typeof this.opt.nextText?this.opt.nextText({this:this}):this.opt.nextText,!1!==a&&this.opt.nextClass&&this._.find(this.nextClass).html(a))};c.prototype.enableNav=function(){this.debug&&console.log("enableNav");if(this.opt.navClass){var a="",b=this,c="";(c="function"==typeof this.opt.prevText?this.opt.prevText({this:b}):this.opt.prevText)&&
this.opt.prevClass&&(a+='<div class="'+this.opt.prevClass+'">'+c+"</div>");c="";(c="function"==typeof this.opt.nextText?this.opt.nextText({this:b}):this.opt.nextText)&&this.opt.nextClass&&(a+='<div class="'+this.opt.nextClass+'">'+c+"</div>");a&&(this._.append('<div class="'+this.opt.navClass+'">'+a+"</div>"),this.opt.prevClass&&this._.find(this.prevClass).click(function(){b.prev()}),this.opt.nextClass&&this._.find(this.nextClass).click(function(){b.next()}))}};c.prototype.prev=function(){this.debug&&
console.log("prev");this.stop();var a=(Math.floor(this.x/this.iWid)+1)*this.iWid;this.x-a>-this.iWid+this.epsilon&&(a+=this.iWid);a>this.xStart&&(this.x-=this.resetAB,a-=this.resetAB,this.stage.css(this.xCSS,this.x+"%"));this.animate(a,90)};c.prototype.next=function(){this.debug&&console.log("next");this.stop();var a=Math.floor(Math.abs(this.x/this.iWid)),b=-(a+1)*this.iWid;Math.abs(this.x)>a*this.iWid+this.epsilon&&(b-=this.iWid);b<this.xEnd&&(this.x+=this.resetAB,b+=this.resetAB,this.stage.css(this.xCSS,
this.x+"%"));this.animate(b,90)};c.prototype.enableKeyboard=function(){this.debug&&console.log("enableKeyboard");var a=this;e(document).keydown(function(b){switch(b.which){case 37:a.prev();break;case 39:a.next();break;default:return}b.preventDefault()})};c.prototype.enableResponsive=function(){this.debug&&console.log("enableResponsive");var a=this;e(window).resize(function(){a._.css("width","");a.init(!0)})};c.prototype.enableHover=function(){this.debug&&console.log("enableHover");var a=this;this._.on("mouseenter",
function(){a.hover=!0});this._.on("mouseleave",function(){a.hover=!1;a.displaying||!1!==a.animating||a.display()})};e.fn.sneeitCarousel=function(a){return this.each(function(){new c(e(this),a)})}})(jQuery);